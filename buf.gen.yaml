version: v1
managed:
  enabled: true
plugins:
  # Generate models using the official Swift plugin
  - plugin: buf.build/apple/swift
    opt: Visibility=Public
    out: Generated/swift-protobuf
  # Generate Connect production APIs using the local connect-swift plugin
  - name: connect-swift
    opt: >
      GenerateAsyncMethods=true,
      GenerateCallbackMethods=true,
      Visibility=Public
    out: Generated/connect-swift
    path: ./plugins/protoc-gen-connect-swift
  # Generate Connect mocks using the local connect-swift plugin
  - name: connect-swift
    opt: >
      GenerateAsyncMocks=true,
      GenerateCallbackMocks=true,
      GenerateAsyncMethods=false,
      GenerateCallbackMethods=false,
      ExtraModuleImports=Generated
    out: GeneratedMocks/connect-swift
    path: ./plugins/protoc-gen-connect-swift
